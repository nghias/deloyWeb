name: Deploy Frontend to Somee.com via FTP

on:
  push:
    branches:
      - main  # Workflow sẽ chạy khi bạn đẩy mã lên nhánh 'main'
  workflow_dispatch:  # Cho phép bạn chạy thủ công từ tab Actions

permissions:
  contents: read  # Quyền đọc mã nguồn trong repo
  pages: write  # Quyền ghi lên GitHub Pages (nếu có cần dùng)
  id-token: write  # Quyền sử dụng token

jobs:
  deploy:
    runs-on: ubuntu-latest  # Sử dụng môi trường Ubuntu

    steps:
      # Bước 1: Checkout mã nguồn từ GitHub
      - name: Checkout code
        uses: actions/checkout@v3

      # Bước 2: Cài đặt lftp (FTP client)
      - name: Install lftp
        run: sudo apt-get install -y lftp

      # Bước 3: Upload các tệp từ thư mục hiện tại lên FTP của Somee.com
      - name: Deploy to Somee.com via FTP
        run: |
          lftp -u ${{ secrets.FTP_USERNAME }},${{ secrets.FTP_PASSWORD }} ${{ secrets.FTP_SERVER }} <<EOF
          mirror -R ./ /wwwroot/  # Upload tất cả tệp từ thư mục hiện tại lên thư mục /wwwroot/ trên Somee.com
          quit
          EOF
        env:
          FTP_SERVER: ${{ secrets.FTP_SERVER }}  # Địa chỉ FTP của bạn
          FTP_USERNAME: ${{ secrets.FTP_USERNAME }}  # Tên người dùng FTP
          FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}  # Mật khẩu FTP
