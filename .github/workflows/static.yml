name: Deploy to Somee.com via FTP

on:
  push:
    branches:
      - main  # Chạy workflow khi có đẩy mã lên nhánh main
  workflow_dispatch:  # Cho phép chạy thủ công từ tab Actions

permissions:
  contents: read  # Quyền đọc nội dung trong repo
  pages: write  # Quyền ghi lên GitHub Pages (nếu có cần dùng)
  id-token: write  # Quyền sử dụng token

jobs:
  deploy:
    runs-on: ubuntu-latest  # Chạy trên môi trường Ubuntu

    steps:
      # Bước 1: Checkout mã nguồn
      - name: Checkout code
        uses: actions/checkout@v3

      # Bước 2: Cài đặt lệnh FTP (sử dụng lftp hoặc curl)
      - name: Install lftp
        run: sudo apt-get install -y lftp

      # Bước 3: Upload các tệp lên Somee.com qua FTP
      - name: Deploy to Somee.com via FTP
        run: |
          lftp -u ${{ secrets.FTP_USERNAME }},${{ secrets.FTP_PASSWORD }} ${{ secrets.FTP_SERVER }} <<EOF
          mirror -R ./_site /wwwroot/  # Thay đổi đường dẫn nếu cần
          quit
          EOF
        env:
          FTP_SERVER: ${{ secrets.FTP_SERVER }}
          FTP_USERNAME: ${{ secrets.FTP_USERNAME }}
          FTP_PASSWORD: ${{ secrets.FTP_PASSWORD }}

